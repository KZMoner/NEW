@model RotienViewModel
@{
    ViewData["Title"] = "Home Page";
}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    .form {
        border: none;
        border-bottom: 1px solid #ccc;
        /* adjust color as needed */
        border-radius: 0;
        box-shadow: none;
        font-size: 20px;
    }

    .form:focus {
        outline: none;
        box-shadow: none;
        border-bottom: 2px solid #0d6efd;
        /* optional focus color */
    }

    /* Optional: smoother hover effect */
    .table-hover tbody tr:hover {
        background-color: #e2f0ff;
        transition: background-color 0.3s ease;
    }

    /* Optional: card-like shadow */
    .table-responsive {
        background-color: #fff;
    }
</style>

<!-- Button trigger modal -->
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content shadow-lg rounded-4">

      <!-- Modal Header -->
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title">Create Routine</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body p-4">

        <form asp-action="Create" method="post">
          
          <div class="mb-3">
            <input asp-for="NewRotien.Date"
                   type="date"
                   class="form-control"
                   placeholder="Date"
                   required>
          </div>

          <div class="mb-3">
            <input asp-for="NewRotien.Work"
                   type="text"
                   class="form-control"
                   placeholder="Work"
                   required>
          </div>

          <div class="mb-3">
            <input asp-for="NewRotien.place"
                   type="text"
                   class="form-control"
                   placeholder="Where"
                   required>
          </div>

          <div class="d-flex justify-content-end gap-2 mt-4">
            <button type="submit" class="btn btn-success px-4">Save</button>
            <button type="button" class="btn btn-outline-secondary px-4" data-bs-dismiss="modal">
              Cancel
            </button>
          </div>

        </form>

      </div>

    </div>
  </div>
</div>



<!-- Edit Modal -->

<div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content shadow-lg rounded-4">

      <!-- Modal Header -->
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title">Edit Routine</h5>
        <button type="button"
                class="btn-close btn-close-white"
                data-bs-dismiss="modal"></button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body p-4">

        <form asp-action="Edit" method="post">

          <!-- Hidden ID -->
          <input type="hidden" asp-for="NewRotien.ID" id="EditID" />

          <div class="mb-3">
            <input type="number"
                   class="form-control"
                   id="EditDate"
                   name="NewRotien.Date"
                   placeholder="Date"
                   required>
          </div>

          <div class="mb-3">
            <input type="text"
                   class="form-control"
                   id="EditWork"
                   name="NewRotien.Work"
                   placeholder="Work"
                   required>
          </div>

          <div class="mb-3">
            <input type="text"
                   class="form-control"
                   id="EditPlace"
                   name="NewRotien.place"
                   placeholder="Where"
                   required>
          </div>

          <div class="d-flex justify-content-end gap-2 mt-4">
            <button type="submit" class="btn btn-success px-4">Save</button>
            <button type="button"
                    class="btn btn-outline-secondary px-4"
                    data-bs-dismiss="modal">
              Cancel
            </button>
          </div>

        </form>

      </div>

    </div>
  </div>
</div>


<div class="card">
  <table>
    <tr class="d-flex justify-content-end">
      <th><a href="/Home/Index" class="btn btn-outline-primary">All</a></th>
      <th><a href="/Home/Index?filter=year" class="btn btn-outline-primary">Last Year</a></th>
      <th><a href="/Home/Index?filter=month" class="btn btn-outline-primary">Last Month</a></th>
      <th><a href="/Home/Index?filter=week" class="btn btn-outline-primary">Last Week</a></th>
      <th><a href="/Home/Index?filter=today" class="btn btn-outline-primary">Today</a></th>
    </tr>
  </table>
</div>

<!-- Include Bootstrap CSS if not already included -->
<div class="table-responsive mt-5" style="max-height: 700px; overflow-y: auto;">
    <div class="container ">
        <div class="table-responsive shadow rounded">
            <table class="table table-striped table-hover table-bordered align-middle text-center">
                <thead class="table-primary">
 <tr class="  "> <th  colspan="5" class="text-start">

    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">Add New Record</button>
                   </th></tr>
                    <tr>
                        <th scope="col">No.</th>
                        <th scope="col">Date</th>
                        <th scope="col">Work</th>
                        <th scope="col">Where</th>
                        <th scope="col">Opretion</th>

                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.RotienList)
                    {
                        <tr>
                            <td>@item.ID</td>
                            <td>@item.Date.ToLocalTime().ToString("yyyy-MM-dd")</td>
                            <td>@item.Work</td>
                            <td>@item.place</td>
                            <td>
                                <button class="btn  btn-warning ml-2"
                                    onclick=" editRow('@item.ID','@item.Date','@item.Work','@item.place')">Edit</button>
                                <button class="btn btn-danger ml-2 " onclick=" DeleteItem(@item.ID)">delete</button>
                            </td>
                        </tr>


                    }
                </tbody>
            </table>
        </div>
    </div>
</div>


<script>
    function editRow(id,date, work, place) {
    document.getElementById("EditID").value = id;      
        document.getElementById("EditDate").value = date;
        document.getElementById("EditWork").value = work;
        document.getElementById("EditPlace").value = place;

        var modal = new bootstrap.Modal(document.getElementById('editModal'));
        modal.show();
    }


    function DeleteItem(id) {
        confirmDelete(function () {
          window.location.href = '/Home/Delete?ID=' + id;

        })
    }




    function confirmDelete(onConfirm) {
        const swalWithBootstrapButtons = Swal.mixin({
            customClass: {
                confirmButton: "btn btn-success",
                cancelButton: "btn btn-danger"
            },
            buttonsStyling: false
        });

        swalWithBootstrapButtons.fire({
            title: "Are you sure?",
            text: "You won't be able to revert this!",
            icon: "warning",
            showCancelButton: true,
            confirmButtonText: "Yes, delete it!",
            cancelButtonText: "No, cancel!",
            reverseButtons: true
        }).then((result) => {
            if (result.isConfirmed) {
                onConfirm(); // 🔥 execute delete logic
            } else if (result.dismiss === Swal.DismissReason.cancel) {
                swalWithBootstrapButtons.fire(
                    "Cancelled",
                    "Your file is safe 🙂",
                    "error"
                );
            }
        });
    }
    </script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>